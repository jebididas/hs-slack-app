<!DOCTYPE html>
<html>
<head>
	<title>Auth</title>
  <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
</head>
<body>
<script type="text/javascript">
  function getQuerystring (key) {
    key = key.replace(/[\[]/,"\\\[").replace(/[\]]/,"\\\]");
    var regex = new RegExp("[\\?&]"+key+"=([^]*)");
    var qs = regex.exec(location.search);
    return qs[1];
  }	
  $code = decodeURIComponent(getQuerystring('code'));
  console.log($code);

  $.ajax({
    method: "POST",
    url: "https://slack.com/api/oauth.access?client_id=10392449395.10392827204&client_secret=1a081084c53d5acd8737c8e1427bb958&code="
    		+ $code 
    		+ "&pretty=1",
    success: function(response) {  	
    	localStorage.setItem('slack_access_token', response.access_token);
    	localStorage.setItem('slack_team_name', response.team_name);
    	console.log(localStorage.getItem('slack_access_token'));
    	console.log(localStorage.getItem('slack_team_name'));
    	console.log(response);
      close();
    }
  });	
</script>
</body>
</html>