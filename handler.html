<html>
  <head>
  <link rel="stylesheet" href="main.css">
  <link href="https://fonts.googleapis.com/css?family=Lato:300,300italic,400,700,900,400italic,700italic,900italic" rel="stylesheet" type="text/css">
  <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/css/bootstrap.min.css">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/css/bootstrap-theme.min.css">
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>  
  </head>
  <body>
  <div class="slack-message">
    <div class="left">
      <img class="message-img" src="slack-30.png">
    </div>
    <div class="center">
      <h3 class="message-title">HootBot</h3>
      <p clas="message-details"></p>
    </div>
    <div class="right">
      <p class="message-time"></p>
    </div>
    <div class="clear"></div>
  </div>
  <input id="clickMe" type="button" value="clickme" onclick="postToSlack();" />
    <script>
      function getQuerystring (key) {
        key = key.replace(/[\[]/,"\\\[").replace(/[\]]/,"\\\]");
        var regex = new RegExp("[\\?&]"+key+"=([^]*)");
        var qs = regex.exec(location.search);
        return qs[1];
      }

      function formatDate(date) {
        var hours = date.getHours();
        var minutes = date.getMinutes();
        var ampm = hours >= 12 ? 'PM' : 'AM';
        hours = hours % 12;
        hours = hours ? hours : 12; // the hour '0' should be '12'
        minutes = minutes < 10 ? '0' + minutes : minutes;
        return hours + ':' + minutes + ' ' + ampm;
      }     

      $formattedTime = formatDate(decodeURIComponent(getQuerystring('datetime')));
      $('.message-details').text(decodeURIComponent(getQuerystring('message')));
      $('.message-details').text($formattedTime);    


      function postToSlack() {
        $.ajax({
          method: "POST",
          url: "https://slack.com/api/chat.postMessage?token=xoxp-10392449395-10392282678-10582097568-98ee1cbe14&channel=C0ABJFJLX&text=T" + decodeURIComponent(getQuerystring('message')) + "&pretty=1",
        })
          .done(function( msg ) {
            alert( "Data Saved: " + msg );
          });

      }
    </script>

    
  </body>
</html>