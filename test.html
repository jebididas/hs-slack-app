<!DOCTYPE html>
<html>
<head>
	<title>Poo</title>
	<link rel="stylesheet" href="main.css">
	<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css">
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>
</head>
<body>
  <div class="channel-cont">
    <div class="channel-dropdown dropdown">
      <button class="btn btn-warning btn-xs dropdown-toggle" type="button" id="channelDropdown" data-toggle="dropdown">
        general 
        <span class="caret"></span>
      </button>
      <ul id="dropdown-channel-menu" class="dropdown-menu" aria-labelledby="channelDropdown">
        <li><a href="#">No Channels</a></li>
      </ul>
    </div>
    <div class="channel-desc">Channel</div>
  </div>
	<div class="slack-message">
		<div class="left">
			<img class="message-img" src="slack-30.png">
		</div>
		<div class="center">
			<h3 class=message-title>incoming-webhook-bot</h3>
			<p clas="message-details">Click here for details!</p>
		</div>
		<div class="right">
			<p class="message-time">3:04 PM</p>
		</div>
		<div class="clear"></div>
	</div>
<button id="postToSlack" class="btn btn-default post-btn">Post to general channel</button>
<button id="oAuthButton" class="btn btn-default post-btn">Login</button>
<button class="btn btn-default"><a target="_blank" href="https://slack.com/oauth/authorize?client_id=10392449395.10392827204?state=1a081084c53d5acd8737c8e1427bb958?redirect_uri=https://hs-slack.herokuapp.com/auth.html">Login</a></button>


<script>
  
  $channel = "C0ABJFJLX"; 
  $.ajax({
    method: "GET",
    url: "https://slack.com/api/channels.list?token=xoxp-10392449395-10392282678-10582097568-98ee1cbe14",
    success: function(response) {
      $('#postToSlack').text('Post to ' + response.channels[0].name + ' channel');
      $('#dropdown-channel-menu').empty();
      response.channels.forEach(function(channel) {
      	console.log(channel.id);
        $listItem = $('<li>');
        $listItem.append('<a id="' + channel.id + '" class="channelSelector" href="#">' + channel.name + '</a>');
        $($listItem).appendTo('#dropdown-channel-menu');
      });
      $('.channelSelector').on('click', function() {
        $('#channelDropdown').text($(this).text());
        $('#channelDropdown').append(' <span class="caret"></span>');
        $('#postToSlack').text('Post to ' + $(this).text() + ' channel');
        $channel = $(this).attr('id');
      });
    }
  })
  .done(function() {
  });  
  function postToSlack() {
    $.ajax({
      method: "POST",
      url: "https://slack.com/api/chat.postMessage?token=xoxp-10392449395-10392282678-10582097568-98ee1cbe14&channel=C0ABJFJLX&text=Test%20Message%20from%20Tester&pretty=1",
    })
      .done(function( msg ) {
        alert( "Data Saved: " + msg );
      });

  }
</script>
</body>
</html>